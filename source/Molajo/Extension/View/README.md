# WORKING WITH MOLAJO VIEWS #

Please check the README file on the root for the location of other README files.

---

## SECTION I. Introduction ##

### What is a View? ###

A View is a set of files used to format and display data.

Views can be shared between extensions.

There are several different types of views, called 'view types'.

### What is a View Type? ###

View Types are designed to handle specific types of rendered output, including:

* formfields - views used to generate form fields
* Page - views used within a theme to define the page layout using <include:xzy statements
* Template - views shared by components, modules, and triggers
* Wrap - views used to wrap output generated by other views (these are often called "chrome" or "styles")

### What is a Controller? ###

A Controller controls the logic flow, instructing the Model and View to do specific tasks.

### What is a Model? ###

A Model retrieves data as instructed by the controller.

### What is a Rowset? ###

Rowsets are collections of data retrieved by the Model at the instruction of the Controller.

The Controller processes each resultset, one at a time in a loop, passing data into the View.

The View formats and displays data from the resultset.

### What is a row? ###

A row is single set of columns with data about a specific item contained within the $this->row array. To view all columns at one time, use this command:

    <?php echo '<pre>';
    var_dump($this->row);
    echo '</pre>'; ?>

### What is a column? ###

A column is a single piece of information about an item. Display the data for a column, as follows:

    <?php echo $this->row->title; ?>

---

## SECTION II. What is a Molajo View? ##

### What is a Molajo View? ###

A Molajo View is a collection of files used to render output from Molajo Extensions.

Views can be reused by any Component, Module, or Trigger. Even Form Field Types are generated by Views.

There are four view types: formfields, Page, Template, and Wrap.

### What is the structure of a View? ###

A View is organized in the following way:

    view-type
        ...view-name
        ... ... css
        ... ... ... Files with CSS extension are automatically loaded
        ... ... ... Files that begin with rtl_ are loaded for RTL Languages.
        ... ... images
        ... ... ... View images go here
        ... ... js
        ... ... ... All files with a JS extension are automatically loaded
        ... ... language
        ... ... ... en-GB
        ... ... ... ... en-GB.view-name.ini
        ... ... ... ... en-GB.view-name.sys.ini
        ... ... views
        ... ... ... top.php
        ... ... ... Header.php
        ... ... ... Body.php
        ... ... ... Footer.php
        ... ... ... bottom.php
        ... ... view-name.xml

---

## SECTION III. Where are views located? ##

Views can be found in four places in a Molajo website, as defined below.

1. Views stored in the platforms/molajo/mvc/views folder are available for any extension. These are the default views that do not override any other location. These are also the only views that are upgraded by Molajo.

2. Views stored in the extensions/View/view-type/view-name folder override the views above and are available for any extension. It is acceptable to customize these views as views located here will never be upgraded by Molajo.

3. Views stored with in the views folder for the extension itself can only be used by that extension, overriding each of the previous locations. It is acceptable to customize these views as views located here will never be upgraded by Molajo.

4. Views can also be placed in the current theme folder and override all other views. It is acceptable to customize these views as views located here will never be upgraded by Molajo.

---

## SECTION IV. How do I know what view a specific extension is using? ##

---

## SECTION V. How can I create Template? ##

### How can I install a Molajo View? ###

To install a Molajo View, use the Molajo Administrator-Extension Manager-Install option.

### How can I share my View with other Molajo users? ###

Create a github repository and upload your View package. Zip up your GPL, free of charge View and post it XYZ

To create a View, navigate to the Molajo Administrator Extension Manager.

Use the 'Create' Submenu Item.

---

## SECTION VI. How do I override a view? ##

### What sequence does Molajo use to search for Views? ###

Molajo searches for Views using the first found with the view name, in this order:

* extensions/themes/theme-name/view-type/view-name

* extensions/component/view-type/view-name (also for the module and trigger folders)

* extensions/View/view-type/view-name

* platforms/molajo/mvc/views


### How do I override a view? ###

Simply place a view with the same name in a location with a higher search priority.

For example, if you are trying to override a view located in platforms/molajo/mvc/views, you could place a like-named view in any of the other three locations defined above.

---

## SECTION VII. Working with CSS, JS, and other media catalog ##

### How do I add CSS for a View?

Place the CSS files into the view-name/css folder. Files with a CSS extension are automatically loaded.

### How do I provide for right-to-left Languages? ###

Name files rtl_put-your-filename-here.css to indicate files which should only be loaded for when serving a right-to-left Language.

### How do I add JS to a View? ###

Place the JS files into the view-name/js folder. All files with a JS extension are automatically loaded.

### How can I include images? ###

Add images to the view-name/images folder and use <img src="../images/name.jpg" /> within the view files.

### What about Language files? ###

Place language files within the project in the languages/xx-XX/ folder, named as follows:

Name files:
* xx-XX.view-name.ini
* xx-XX.view-name.sys.ini

### How does Molajo decide which CSS and JSS files to load? ###

#### Site-specific and Shared by all sites ####

Molajo's folder structure is organized for multi-site support beneath the sites folder on the root.

Beneath root, each site has a numbered folder (primary site is 1, then 2, and so on) beneath the sites folder for storing and retrieving files and subfolders only for that site. Those files are not accessible by other sites.
* cache
* logs
* media
* temp

There is also a core folder beneath the core subject containing a media folder that is shared by all sites. Only the primary site (the site #1) is able to update that folder. But, media files stored in that location will be loaded for every site.

#### CSS and JS file locations ####

Molajo will load search the site-number/media and core/media folders and load all CSS and JS files in these locations for the specified criteria:

System-wide CSS and JS are always loaded, regardless of content:

##### Always #####

      => media/system/css[js]/XYZ.css[js]

##### Application-specific #####

      => media/system/[application-name]/css[js]/XYZ.css[js]

##### Catalog ID #####

For extensions (components, modules, and triggers), content items and items for a specific primary categories, the catalog id can be used as a folder name to load CSS and JS files. This can be further refined by placing the catalog id folder beneath the application name folder.

      => media/system/[catalog-id]/css[js]/XYZ.css[js]

      => media/system/[application-name]/[catalog-id]/css[js]/XYZ.css[js]


##### View #####

CSS and JS files located within the view-name/css and view-name/js folders are loaded for the view. To override the CSS and JS for a view, one must override the entire view. See topics above for how to override a view and the sequence used to select the view used.

      => selected-view-locate/View/view-type/view-name/css[js]/XYZ.css[js]

---

## SECTION VIII. USING QUERY RESULTS IN VIEWS ##

### How are the view files processed by Molajo? ###

There are two options for using query results:

#### To process the recordset within your view file, include the Custom.php view file. ####

When Molajo finds a Custom.php file, it pushes the $this->resultset object into the file.

The view must handle it's own loop processing for the recordset.

#### To allow Molajo to handle recordset process, don't include the Custom.php file. ####

Instead, use the:

 1. top.php
 2. Header.php
 3. Body.php
 4. Footer.php
 5. bottom.php

#### How does the Molajo View process the recordset and render the view files? ####

The Molajo View loops through each row, one at a time.

The following view-type/view-name/View/ files are included, if existing:

##### Before any rows and if there is a top.php file: #####

* The Event **beforeDisplayContent** is fired and the output is rendered;
* Then *top.php* file is included.

##### Each row is processed one at a time, as follows: #####

* if there is a **Header.php** file, it is included and event **afterDisplayTitle** output is rendered.
* if there is a **Body.php** file, it is included.
* if there is a **Footer.php** file, it is included.

##### After all rows have been processed, and if there is a Footer.php file: #####
* the *Footer.php* file is included;
* *afterDisplayContent* output is rendered;

---

# SECTION IX. WHAT DATA IS AVAILABLE WITHIN A VIEW FILE? #

## What data is available within the View file? ##

### Application Object ###

Includes data about the application configuration, language, and response elements, such as JS and CSS loaded thus far, and the meta data, page title, and so on.

To display all of the options available:

    <?php echo '<pre>'; var_dump(Molajo::Application()); echo '</pre>';  ?>

To display one item:

    <?php echo Services::Registry()->get('Configuration', 'sef'); ?>

### User ###

To display all of the options available:

    <?php echo '<pre>'; var_dump(Services::User()); echo '</pre>';  ?>

To display one item:

    <?php echo Services::User()->username; ?>

### Input Request ###

    <?php echo '<pre>'; var_dump(Molajo::Application()->input); echo '</pre>';  ?>

### Query Criteria ###

    <?php echo '<pre>'; var_dump($this->state); echo '</pre>';  ?>

### Parameters ###

Extension, Theme

    <?php echo '<pre>'; var_dump($this->params); echo '</pre>';  ?>

### Query Results ###

All rows

    <?php echo '<pre>'; var_dump($this->resultset); echo '</pre>';  ?>

Single Row

    <?php echo '<pre>'; var_dump($this->row); echo '</pre>';  ?>

Specific Column

    <?php echo echo $this->row->title; ?>

Pagination

    <?php echo '<pre>'; var_dump($this->pagination); echo '</pre>';  ?>

### View ###

Path to view

    <?php echo $this->view_path; ?>

Name of view

    <?php echo $this->view; ?>

Wrap

    <?php echo $this->wrap; ?>

---

# SECTION X. WORKING WITH DATES #

1. What options are available for formatting dates in views?

Dates can be formatted one of two ways, using PHP date or the JHtml class.

2. How can PHP's Date function be used in a view?

http://php.net/manual/en/function.date.php

Example:
        $today = date("F j, Y, g:i a"); // March 10, 2001, 5:16 pm

3. How can Joomla's JHtml function be used in a view to format dates?

        $date	= JHtml::_('date', $this->row->created,      Services::Languages()->translate('DATE_FORMAT_LC1'));
        $time	= JHtml::_('date', $this->row->checked_out_time, 'H:i');

Options:
        DATE_FORMAT_LC="l, d F Y"
        DATE_FORMAT_LC1="l, d F Y"
        DATE_FORMAT_LC2="l, d F Y H:i"
        DATE_FORMAT_LC3="d F Y"
        DATE_FORMAT_LC4="Y-m-d"
        DATE_FORMAT_JS1="y-m-d"

4. How can I change the date formats for Molajo?

Date formats can be changed by overriding the language file.

---

# SECTION XI. INTEGRATING OTHER EXTENSION OUTPUT WITHIN A VIEW #

1. How can I render the output for another Component View within the View file?

        $this->render ('component-name', array('view' => 'value', 'criteria1' => 'value'));

2. How can I render Module output within the View File?

        $this->render ('module', 'module-name', array('parameter1' => 'value', 'parameter2' => 'value');

3. How can I render a Module Position within the View File?

        $this->render ('position', 'position-name', array('wrap' => 'name-of-wrap');

---

# SECTION XII. WORKING WITH IMAGES #

1. System Configuration

Locations:

Sizes:

 * 0 - original size
 * 1 - xsmall; configuration option, defaults to 50 x 50
 * 2 - small; configuration option, defaults to 75 x 75
 * 3 - medium; configuration option, defaults to 150 x 150
 * 4 - large; configuration option, defaults to 300 x 300
 * 5 - xlarge; configuration option, defaults to 500 x 500

Types:

2. How can I resize an image within a view?

Add this to your view or within your content.

        {image name="dog.png" size=1 type=2}

---

# SECTION XIII. USING OTHER THEME SYSTEMS #

1. What does Molajo use as a default view environment?

The MolajoView class handles view processing. Normal PHP are used in core View files.

2. How can I use Twig to render Molajo output?

3. How can I add <insert name of your favorite Theme System here> to render Molajo Output?

Simply load the files needed within your component entry point file and then use them in your View.

